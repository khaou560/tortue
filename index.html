<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f5f5f5;
      margin: 0;
      padding: 10px;
    }
    h1 {
      color: #2c3e50;
      font-size: 18px;
      margin-bottom: 5px;
    }
    canvas {
      border: 2px solid #34495e;
      background-color: #f9f9f9;
      background-image: 
        linear-gradient(#ddd 1px, transparent 1px),
        linear-gradient(90deg, #ddd 1px, transparent 1px);
      background-size: 50px 50px; /* Grille de 50px */
      display: block;
      margin: 10px auto;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .controls {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px auto;
      max-width: 500px;
    }
    button {
      padding: 8px 12px;
      font-size: 14px;
      cursor: pointer;
      min-width: 80px;
      border: none;
      border-radius: 4px;
    }
    .avance { background-color: #2ecc71; color: white; }
    .recule { background-color: #e74c3c; color: white; }
    .tourne { background-color: #f39c12; color: white; }
    #reset { background-color: #9b59b6; color: white; }
    .grid-info {
      color: #7f8c8d;
      font-size: 12px;
      margin: 5px 0;
    }
  </style>
</head>
<body>
  
  <canvas id="canvas" width="500" height="400"></canvas>

  <div class="controls">
    <button class="avance" onclick="avance(50)">AV 50</button>
    <button class="avance" onclick="avance(100)">AV 100</button>
    <button class="recule" onclick="avance(-100)">RE 100</button>
    <button class="tourne" onclick="tourneDroite(90)">TD 90</button>
    <button class="tourne" onclick="tourneGauche(90)">TG 90</button>
    <button id="reset" onclick="reset()">R√©initialiser</button>
  </div>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  // Configuration
  const gridSize = 50; // Grille de 50px
  let x = gridSize * 2; // D√©part √† 100px du bord gauche (ligne verticale)
  let y = canvas.height - gridSize; // D√©part sur la ligne du bas
  let angle = -90; // Orient√© vers le haut
  let pathHistory = [];

  // Position cible (align√©e sur la grille)
  const targetX = gridSize * 5; // 250px
  const targetY = gridSize * 2; // 100px
  const targetRadius = 10;

  // Initialisation
  reset();

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawGridWithNumbers();
    drawTarget();
    redrawPathHistory();
    drawTurtle();
  }

  function drawGridWithNumbers() {
    ctx.strokeStyle = '#ddd';
    ctx.lineWidth = 1;
    ctx.font = '10px Arial';
    ctx.fillStyle = '#aaa';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';

    // Lignes verticales
    for (let i = 0; i <= canvas.width; i += gridSize) {
      ctx.beginPath();
      ctx.moveTo(i, 0);
      ctx.lineTo(i, canvas.height);
      ctx.stroke();
      if (i > 0) ctx.fillText(i, i, 10);
    }

    // Lignes horizontales
    for (let i = 0; i <= canvas.height; i += gridSize) {
      ctx.beginPath();
      ctx.moveTo(0, i);
      ctx.lineTo(canvas.width, i);
      ctx.stroke();
      if (i > 0) ctx.fillText(i, 10, i);
    }
  }

  function drawTarget() {
    ctx.beginPath();
    ctx.arc(targetX, targetY, targetRadius, 0, Math.PI * 2);
    ctx.fillStyle = "red";
    ctx.fill();
    ctx.strokeStyle = "darkred";
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  function drawTurtle() {
    ctx.save();
    ctx.translate(x, y);
    ctx.rotate(angle * Math.PI / 180);
    ctx.font = '22px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText("üê¢", 0, 0);
    ctx.restore();
  }

  function redrawPathHistory() {
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 2;
    ctx.beginPath();
    
    for (const point of pathHistory) {
      if (point.isMove) {
        ctx.lineTo(point.x, point.y);
      } else {
        ctx.moveTo(point.x, point.y);
      }
    }
    
    ctx.stroke();
  }

  function avance(distance) {
    const rad = angle * (Math.PI / 180);
    const newX = x + distance * Math.cos(rad);
    const newY = y + distance * Math.sin(rad);

    pathHistory.push({ x: x, y: y, isMove: false });
    pathHistory.push({ x: newX, y: newY, isMove: true });

    x = newX;
    y = newY;
    
    draw();
    checkWin();
  }

  function tourneDroite(deg) {
    angle += deg;
    draw();
  }

  function tourneGauche(deg) {
    angle -= deg;
    draw();
  }

  function checkWin() {
    const dist = Math.sqrt((x - targetX) ** 2 + (y - targetY) ** 2);
    if (dist < targetRadius + 5) {
      setTimeout(() => {
        alert("F√©licitations ! üéâ\nVous avez atteint la cible !");
      }, 50);
    }
  }

  function reset() {
    x = gridSize * 2; // 100px du bord gauche
    y = canvas.height - gridSize; // Ligne du bas
    angle = -90;
    pathHistory = [];
    pathHistory.push({ x: x, y: y, isMove: false });
    draw();
  }
</script>
</body>
</html>
